================================================================================
SHARPAPI - REAL-TIME SPORTS BETTING ODDS API
Complete Documentation for LLM Integration
================================================================================

OVERVIEW
--------------------------------------------------------------------------------
SharpAPI is a real-time sports betting odds API providing:
- Live odds from 15+ sportsbooks (DraftKings, FanDuel, BetMGM, Caesars, ESPN Bet, Fanatics, BetRivers, PointsBet, Bet365, Unibet, Hard Rock, SuperBook, WynnBET, Betfred)
- Sharp book reference odds from Pinnacle for true probability
- +EV (Expected Value) opportunity detection
- Cross-book arbitrage detection with stake calculations
- Middle opportunity detection for spread/total betting
- Real-time SSE streaming for instant alerts
- Kelly Criterion stake sizing recommendations

Base URL: https://sharpapi.io/api/v1

API Version: 1.0.0

================================================================================
AUTHENTICATION
================================================================================

Three authentication methods are supported:

1. Header Authentication (Recommended)
   X-API-Key: sk_your_api_key

2. Bearer Token
   Authorization: Bearer sk_your_api_key

3. Query Parameter
   ?api_key=sk_your_api_key

Test Keys (Development/Preview Only):
- sk_test_free  - Free tier testing
- sk_test_pro   - Pro tier testing
- sk_test_sharp - Sharp tier testing

Production keys are obtained from https://sharpapi.io/dashboard

================================================================================
SUBSCRIPTION TIERS
================================================================================

FEATURE COMPARISON
--------------------------------------------------------------------------------
| Feature                    | Free      | Pro       | Sharp     |
|----------------------------|-----------|-----------|-----------|
| Discovery Endpoints        | Yes       | Yes       | Yes       |
| Basic Odds                 | 5s delay  | Real-time | Real-time |
| Best Odds                  | No        | Yes       | Yes       |
| Batch Requests             | No        | 10 events | 50 events |
| EV Opportunities           | No        | Yes       | Yes       |
| Arbitrage Detection        | No        | Yes       | Yes       |
| Value Bets                 | No        | Yes       | Yes       |
| Middles Detection          | No        | No        | Yes       |
| Player Props               | No        | Yes       | Yes       |
| Alternate Lines            | No        | Yes       | Yes       |
| SSE Streams                | 1         | 3         | 10        |
| Combined Stream            | No        | No        | Yes       |
| Requests/minute            | 100       | 1,000     | Unlimited |

COMING SOON (All Tiers):
- Odds Movements (historical line changes)
- Odds History/Rewind
- Results & Grading
- Closing Line Value (CLV)
- Same-Game Parlays (SGP)
- User Preferences
- Webhooks

================================================================================
RATE LIMITING
================================================================================

Rate limits are enforced per API key:

| Tier   | Requests/Minute | Concurrent Streams |
|--------|-----------------|-------------------|
| Free   | 100             | 1                 |
| Pro    | 1,000           | 3                 |
| Sharp  | Unlimited       | 10                |

Rate Limit Headers (included in all responses):
- X-RateLimit-Limit: Maximum requests allowed
- X-RateLimit-Remaining: Requests remaining in window
- X-RateLimit-Reset: Unix timestamp when limit resets

When rate limited, responses return HTTP 429 with:
{
  "error": "Rate limit exceeded",
  "code": "rate_limit_exceeded",
  "retry_after": 30,
  "upgrade_url": "https://sharpapi.io/pricing"
}

================================================================================
ERROR CODES
================================================================================

| HTTP | Code                    | Description                          |
|------|-------------------------|--------------------------------------|
| 400  | invalid_request         | Malformed request or parameters      |
| 401  | unauthorized            | Missing or invalid API key           |
| 403  | tier_required           | Endpoint requires higher tier        |
| 404  | not_found               | Resource not found                   |
| 429  | rate_limit_exceeded     | Rate limit exceeded                  |
| 429  | stream_limit_exceeded   | Max concurrent streams reached       |
| 500  | internal_error          | Server error                         |

Error Response Format:
{
  "error": "Human-readable error message",
  "code": "machine_readable_code",
  "required_tier": "pro",           // If tier_required
  "upgrade_url": "https://...",     // Upgrade link
  "retry_after": 30                 // If rate limited (seconds)
}

================================================================================
DISCOVERY ENDPOINTS
================================================================================

GET /sports
--------------------------------------------------------------------------------
Returns list of available sports with event counts.

Authentication: Required (any tier)
Rate Limit: Standard

Query Parameters: None

Example Request:
  curl -H "X-API-Key: sk_test_free" https://sharpapi.io/api/v1/sports

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "sports": [
    {
      "id": "basketball",
      "name": "Basketball",
      "leagues": ["NBA", "NCAAB", "WNBA"],
      "eventCount": 42,
      "liveEventCount": 3
    },
    {
      "id": "football",
      "name": "Football",
      "leagues": ["NFL", "NCAAF"],
      "eventCount": 28,
      "liveEventCount": 1
    }
  ]
}

Response Fields:
- id: Lowercase sport identifier for filtering
- name: Display name
- leagues: Array of league identifiers within the sport
- eventCount: Total events with odds
- liveEventCount: Currently in-play events

--------------------------------------------------------------------------------
GET /leagues
--------------------------------------------------------------------------------
Returns leagues with filtering by sport.

Authentication: Required (any tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type   | Required | Description                    |
|-----------|--------|----------|--------------------------------|
| sport     | string | No       | Filter by sport (e.g., "nba")  |

Example Request:
  curl -H "X-API-Key: sk_test_free" \
    "https://sharpapi.io/api/v1/leagues?sport=basketball"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "filter": { "sport": "basketball" },
  "leagues": [
    {
      "id": "nba",
      "name": "NBA",
      "sport": "basketball",
      "eventCount": 15,
      "liveEventCount": 2
    },
    {
      "id": "ncaab",
      "name": "NCAAB",
      "sport": "basketball",
      "eventCount": 27,
      "liveEventCount": 1
    }
  ]
}

--------------------------------------------------------------------------------
GET /events
--------------------------------------------------------------------------------
Returns events with filtering, pagination, and optional odds inclusion.

Authentication: Required (any tier)
Rate Limit: Standard

Query Parameters:
| Parameter     | Type    | Required | Default | Description                     |
|---------------|---------|----------|---------|---------------------------------|
| sports        | string  | No       | all     | Comma-separated sport filter    |
| leagues       | string  | No       | all     | Comma-separated league filter   |
| live          | boolean | No       | false   | Only live events if true        |
| include_odds  | boolean | No       | false   | Include odds in response        |
| limit         | integer | No       | 50      | Results per page (max 200)      |
| offset        | integer | No       | 0       | Pagination offset               |

Example Request:
  curl -H "X-API-Key: sk_test_free" \
    "https://sharpapi.io/api/v1/events?sports=nba,nfl&limit=20"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "pagination": {
    "total": 43,
    "limit": 20,
    "offset": 0,
    "hasMore": true
  },
  "filters": {
    "sports": ["nba", "nfl"],
    "leagues": "all",
    "live": false
  },
  "events": [
    {
      "id": "evt_nba_lal_bos_20240115",
      "externalIds": {
        "draftkings": "12345",
        "fanduel": "67890"
      },
      "sport": "basketball",
      "league": "NBA",
      "homeTeam": "Boston Celtics",
      "awayTeam": "Los Angeles Lakers",
      "startTime": "2024-01-15T19:30:00.000Z",
      "status": "scheduled",
      "isLive": false,
      "markets": ["moneyline", "spread", "total", "player_prop"],
      "bookCount": 5
    }
  ]
}

--------------------------------------------------------------------------------
GET /events/live
--------------------------------------------------------------------------------
Returns only live (in-play) events with scores.

Authentication: Required (any tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type   | Required | Description                    |
|-----------|--------|----------|--------------------------------|
| sports    | string | No       | Comma-separated sport filter   |
| leagues   | string | No       | Comma-separated league filter  |

Example Request:
  curl -H "X-API-Key: sk_test_free" \
    "https://sharpapi.io/api/v1/events/live?sports=nba"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T20:45:00.000Z",
  "count": 3,
  "events": [
    {
      "id": "evt_nba_lal_bos_20240115",
      "sport": "basketball",
      "league": "NBA",
      "homeTeam": "Boston Celtics",
      "awayTeam": "Los Angeles Lakers",
      "startTime": "2024-01-15T19:30:00.000Z",
      "status": "in_progress",
      "isLive": true,
      "liveScore": {
        "home": 78,
        "away": 72,
        "period": "Q3",
        "clock": "5:42"
      },
      "markets": ["moneyline", "spread", "total"],
      "bookCount": 5
    }
  ]
}

--------------------------------------------------------------------------------
GET /events/{eventId}
--------------------------------------------------------------------------------
Returns detailed information for a single event including all odds.

Authentication: Required (any tier)
Rate Limit: Standard

Path Parameters:
| Parameter | Type   | Required | Description          |
|-----------|--------|----------|----------------------|
| eventId   | string | Yes      | Event identifier     |

Example Request:
  curl -H "X-API-Key: sk_test_free" \
    "https://sharpapi.io/api/v1/events/evt_nba_lal_bos_20240115"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "event": {
    "id": "evt_nba_lal_bos_20240115",
    "sport": "basketball",
    "league": "NBA",
    "homeTeam": "Boston Celtics",
    "awayTeam": "Los Angeles Lakers",
    "startTime": "2024-01-15T19:30:00.000Z",
    "status": "scheduled",
    "isLive": false
  },
  "markets": {
    "moneyline": [
      {
        "sportsbook": "draftkings",
        "selection": "Boston Celtics",
        "odds": { "american": -180, "decimal": 1.556, "probability": 0.643 }
      },
      {
        "sportsbook": "draftkings",
        "selection": "Los Angeles Lakers",
        "odds": { "american": +155, "decimal": 2.55, "probability": 0.392 }
      }
    ],
    "spread": [...],
    "total": [...]
  },
  "oddsCount": 48
}

--------------------------------------------------------------------------------
GET /events/search
--------------------------------------------------------------------------------
Search events by team name.

Authentication: Required (any tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type    | Required | Default | Description                   |
|-----------|---------|----------|---------|-------------------------------|
| q         | string  | Yes      | -       | Search query (min 2 chars)    |
| live      | boolean | No       | false   | Only search live events       |
| limit     | integer | No       | 20      | Max results (max 100)         |

Example Request:
  curl -H "X-API-Key: sk_test_free" \
    "https://sharpapi.io/api/v1/events/search?q=lakers"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "query": "lakers",
  "count": 3,
  "events": [
    {
      "id": "evt_nba_lal_bos_20240115",
      "sport": "basketball",
      "league": "NBA",
      "homeTeam": "Boston Celtics",
      "awayTeam": "Los Angeles Lakers",
      "startTime": "2024-01-15T19:30:00.000Z",
      "isLive": false,
      "matchedTeam": "Los Angeles Lakers",
      "bookCount": 5
    }
  ]
}

================================================================================
ODDS ENDPOINTS
================================================================================

GET /odds
--------------------------------------------------------------------------------
Returns current odds snapshot with filtering.

Authentication: Required (any tier)
Rate Limit: Standard
Data Delay: Free tier has 5-second delay

Query Parameters:
| Parameter   | Type   | Required | Default | Description                        |
|-------------|--------|----------|---------|------------------------------------|
| sports      | string | No       | all     | Comma-separated sports             |
| books       | string | No       | all     | Comma-separated sportsbooks        |
| market_type | string | No       | all     | Filter by market type              |
| event_ids   | string | No       | -       | Comma-separated event IDs (batch)  |
| limit       | integer| No       | 100     | Max results (max 500)              |

Market Types:
- moneyline
- spread
- total
- team_total
- player_prop
- alternate_spread
- alternate_total
- futures

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/odds?sports=nba&market_type=moneyline"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "count": 24,
  "filters": {
    "sports": ["nba"],
    "books": "all",
    "marketType": "moneyline"
  },
  "odds": [
    {
      "id": "dk_nba_lal_bos_ml_home",
      "sportsbook": "draftkings",
      "sportsbookDisplayName": "DraftKings",
      "eventId": "evt_nba_lal_bos_20240115",
      "externalEventId": "12345",
      "sport": "basketball",
      "league": "NBA",
      "homeTeam": "Boston Celtics",
      "awayTeam": "Los Angeles Lakers",
      "marketType": "moneyline",
      "selection": "Boston Celtics",
      "selectionType": "home",
      "odds": {
        "american": -180,
        "decimal": 1.556,
        "probability": 0.643
      },
      "eventStartTime": "2024-01-15T19:30:00.000Z",
      "timestamp": "2024-01-15T10:30:00.000Z",
      "isLive": false,
      "status": "scheduled"
    }
  ]
}

Batch Requests (Pro: 10 events, Sharp: 50 events):
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/odds?event_ids=evt_1,evt_2,evt_3"

--------------------------------------------------------------------------------
GET /odds/best
--------------------------------------------------------------------------------
Returns best available odds for each selection across all sportsbooks.

Authentication: Required (Pro+ tier)
Rate Limit: Standard

Query Parameters:
| Parameter   | Type   | Required | Default | Description                   |
|-------------|--------|----------|---------|-------------------------------|
| sports      | string | No       | all     | Comma-separated sports        |
| market_type | string | No       | all     | Filter by market type         |
| limit       | integer| No       | 100     | Max results (max 500)         |

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/odds/best?sports=nba&market_type=spread"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "count": 15,
  "filters": {
    "sports": ["nba"],
    "marketType": "spread"
  },
  "bestOdds": [
    {
      "eventId": "evt_nba_lal_bos_20240115",
      "eventName": "Los Angeles Lakers @ Boston Celtics",
      "sport": "basketball",
      "league": "NBA",
      "marketType": "spread",
      "selection": "Boston Celtics",
      "line": -6.5,
      "bestOdds": {
        "american": -105,
        "decimal": 1.952,
        "probability": 0.512
      },
      "bestBook": "fanduel",
      "allBooks": [
        { "book": "fanduel", "odds": -105, "line": -6.5 },
        { "book": "draftkings", "odds": -110, "line": -6.5 },
        { "book": "betmgm", "odds": -108, "line": -6.5 }
      ],
      "sharpOdds": {
        "american": -108,
        "decimal": 1.926,
        "probability": 0.519
      },
      "sharpBook": "pinnacle",
      "timestamp": "2024-01-15T10:30:00.000Z"
    }
  ]
}

================================================================================
MARKET ENDPOINTS
================================================================================

GET /markets/types
--------------------------------------------------------------------------------
Returns list of available market types.

Authentication: Required (any tier)
Rate Limit: Standard

Example Request:
  curl -H "X-API-Key: sk_test_free" https://sharpapi.io/api/v1/markets/types

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "marketTypes": [
    {
      "id": "moneyline",
      "name": "Moneyline",
      "description": "Bet on which team will win the game",
      "hasLine": false,
      "sports": ["basketball", "football", "hockey", "baseball", "soccer"]
    },
    {
      "id": "spread",
      "name": "Point Spread",
      "description": "Bet on the margin of victory",
      "hasLine": true,
      "lineUnit": 0.5,
      "sports": ["basketball", "football", "hockey", "baseball"]
    },
    {
      "id": "total",
      "name": "Total (Over/Under)",
      "description": "Bet on combined score",
      "hasLine": true,
      "lineUnit": 0.5,
      "sports": ["basketball", "football", "hockey", "baseball"]
    },
    {
      "id": "player_prop",
      "name": "Player Props",
      "description": "Bet on individual player performance",
      "hasLine": true,
      "sports": ["basketball", "football", "hockey", "baseball"]
    }
  ]
}

--------------------------------------------------------------------------------
GET /markets/player-props
--------------------------------------------------------------------------------
Returns player prop odds for events.

Authentication: Required (Pro+ tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type   | Required | Default | Description                    |
|-----------|--------|----------|---------|--------------------------------|
| sports    | string | No       | all     | Comma-separated sports         |
| event_id  | string | No       | -       | Filter by specific event       |
| player    | string | No       | -       | Filter by player name          |
| limit     | integer| No       | 100     | Max results (max 500)          |

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/markets/player-props?sports=nba&player=lebron"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "count": 24,
  "filters": {
    "sports": ["nba"],
    "player": "lebron"
  },
  "playerProps": [
    {
      "id": "dk_lebron_pts_20240115",
      "sportsbook": "draftkings",
      "eventId": "evt_nba_lal_bos_20240115",
      "sport": "basketball",
      "league": "NBA",
      "player": "LeBron James",
      "team": "Los Angeles Lakers",
      "propType": "points",
      "selection": "Over",
      "line": 26.5,
      "odds": {
        "american": -115,
        "decimal": 1.87,
        "probability": 0.535
      },
      "eventStartTime": "2024-01-15T19:30:00.000Z",
      "timestamp": "2024-01-15T10:30:00.000Z"
    }
  ]
}

--------------------------------------------------------------------------------
GET /markets/alternates
--------------------------------------------------------------------------------
Returns alternate spread and total lines.

Authentication: Required (Pro+ tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type   | Required | Default | Description                    |
|-----------|--------|----------|---------|--------------------------------|
| sports    | string | No       | all     | Comma-separated sports         |
| event_id  | string | No       | -       | Filter by specific event       |
| type      | string | No       | both    | "spread", "total", or "both"   |
| limit     | integer| No       | 100     | Max results (max 500)          |

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/markets/alternates?event_id=evt_nba_lal_bos_20240115&type=spread"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "count": 42,
  "filters": {
    "eventId": "evt_nba_lal_bos_20240115",
    "type": "spread"
  },
  "alternates": [
    {
      "id": "dk_lal_bos_altspread_1",
      "sportsbook": "draftkings",
      "eventId": "evt_nba_lal_bos_20240115",
      "marketType": "alternate_spread",
      "selection": "Boston Celtics",
      "line": -10.5,
      "odds": {
        "american": +150,
        "decimal": 2.50,
        "probability": 0.40
      },
      "timestamp": "2024-01-15T10:30:00.000Z"
    }
  ]
}

--------------------------------------------------------------------------------
GET /markets/active
--------------------------------------------------------------------------------
Returns summary of active markets across all events.

Authentication: Required (Pro+ tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type   | Required | Default | Description               |
|-----------|--------|----------|---------|---------------------------|
| sports    | string | No       | all     | Comma-separated sports    |

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/markets/active?sports=nba"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "summary": {
    "totalMarkets": 1250,
    "totalEvents": 45,
    "byMarketType": {
      "moneyline": 90,
      "spread": 90,
      "total": 90,
      "player_prop": 650,
      "alternate_spread": 165,
      "alternate_total": 165
    },
    "bySport": {
      "basketball": 1250
    }
  },
  "markets": [
    {
      "eventId": "evt_nba_lal_bos_20240115",
      "eventName": "Los Angeles Lakers @ Boston Celtics",
      "sport": "basketball",
      "marketTypes": ["moneyline", "spread", "total", "player_prop"],
      "oddsCount": 48,
      "bookCount": 5
    }
  ]
}

================================================================================
OPPORTUNITY ENDPOINTS
================================================================================

GET /ev
--------------------------------------------------------------------------------
Returns +EV (Expected Value) betting opportunities.

Authentication: Required (Pro+ tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type   | Required | Default | Description                    |
|-----------|--------|----------|---------|--------------------------------|
| sports    | string | No       | all     | Comma-separated sports         |
| books     | string | No       | soft    | Target sportsbooks             |
| min_ev    | number | No       | 2.0     | Minimum EV percentage          |
| min_kelly | number | No       | 0.5     | Minimum Kelly percentage       |
| limit     | integer| No       | 50      | Max results (max 200)          |

How EV is Calculated:
1. Sharp book (Pinnacle) odds are used as "true" probability
2. No-vig fair odds: fairProb = impliedProb / totalImplied
3. EV% = (fairProbability * decimalOdds - 1) * 100
4. Kelly% = (p * b - q) / b, capped at 25%

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/ev?sports=nba&min_ev=3.0"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "summary": {
    "total": 12,
    "avgEV": 4.2,
    "avgKelly": 2.1,
    "bySport": { "basketball": 8, "football": 4 }
  },
  "count": 12,
  "opportunities": [
    {
      "eventId": "evt_nba_lal_bos_20240115",
      "eventName": "Los Angeles Lakers @ Boston Celtics",
      "sport": "basketball",
      "league": "NBA",
      "marketType": "moneyline",
      "sportsbook": "draftkings",
      "selection": "Los Angeles Lakers",
      "odds": +165,
      "decimalOdds": 2.65,
      "sharpOdds": +145,
      "sharpDecimalOdds": 2.45,
      "sharpBook": "pinnacle",
      "fairProbability": 40.0,
      "evPercent": 6.0,
      "kellyPercent": 2.4,
      "detectedAt": "2024-01-15T10:30:00.000Z"
    }
  ]
}

--------------------------------------------------------------------------------
GET /arbitrage
--------------------------------------------------------------------------------
Returns cross-book arbitrage opportunities.

Authentication: Required (Pro+ tier)
Rate Limit: Standard

Query Parameters:
| Parameter  | Type   | Required | Default | Description                   |
|------------|--------|----------|---------|-------------------------------|
| sports     | string | No       | all     | Comma-separated sports        |
| min_profit | number | No       | 0.5     | Minimum profit percentage     |
| limit      | integer| No       | 50      | Max results (max 200)         |

How Arbitrage Works:
1. Find best odds for each selection across all books
2. Calculate implied probability: 1 / decimalOdds
3. Sum all implied probabilities
4. If total < 1.0, profit exists: profitPercent = (1/total - 1) * 100
5. Calculate stake percentages for guaranteed profit

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/arbitrage?sports=nba&min_profit=1.0"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "summary": {
    "total": 3,
    "avgProfit": 1.8,
    "bySport": { "basketball": 2, "football": 1 }
  },
  "count": 3,
  "opportunities": [
    {
      "eventId": "evt_nba_lal_bos_20240115",
      "eventName": "Los Angeles Lakers @ Boston Celtics",
      "sport": "basketball",
      "league": "NBA",
      "marketType": "moneyline",
      "profitPercent": 2.1,
      "impliedTotal": 0.9794,
      "legs": [
        {
          "selection": "Boston Celtics",
          "sportsbook": "fanduel",
          "odds": { "american": -175, "decimal": 1.571, "probability": 0.636 },
          "stakePercent": 64.97
        },
        {
          "selection": "Los Angeles Lakers",
          "sportsbook": "draftkings",
          "odds": { "american": +175, "decimal": 2.75, "probability": 0.364 },
          "stakePercent": 35.03
        }
      ],
      "detectedAt": "2024-01-15T10:30:00.000Z"
    }
  ]
}

Arbitrage Example Calculation:
- Bet $64.97 on Celtics at 1.571: returns $102.07
- Bet $35.03 on Lakers at 2.75: returns $96.33
- Total stake: $100
- Guaranteed return: $96.33 - $102.07
- Profit: 2.1% regardless of outcome

--------------------------------------------------------------------------------
GET /value-bets
--------------------------------------------------------------------------------
Returns enhanced EV opportunities with confidence analysis.

Authentication: Required (Pro+ tier)
Rate Limit: Standard

Query Parameters:
| Parameter | Type   | Required | Default | Description                    |
|-----------|--------|----------|---------|--------------------------------|
| sports    | string | No       | all     | Comma-separated sports         |
| books     | string | No       | soft    | Target sportsbooks             |
| min_ev    | number | No       | 2.0     | Minimum EV percentage          |
| min_kelly | number | No       | 0.5     | Minimum Kelly percentage       |
| limit     | integer| No       | 50      | Max results (max 200)          |

Additional Analysis:
- Edge over sharp line
- Combined value score (EV + Kelly weighted)
- Confidence rating based on market depth
- Market liquidity estimate
- Time until event starts

Example Request:
  curl -H "X-API-Key: sk_test_pro" \
    "https://sharpapi.io/api/v1/value-bets?sports=nba&min_ev=3.0"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "summary": {
    "total": 8,
    "avgEV": 4.5,
    "avgKelly": 2.2,
    "highConfidence": 3,
    "mediumConfidence": 4,
    "lowConfidence": 1
  },
  "count": 8,
  "valueBets": [
    {
      "eventId": "evt_nba_lal_bos_20240115",
      "eventName": "Los Angeles Lakers @ Boston Celtics",
      "sport": "basketball",
      "league": "NBA",
      "marketType": "spread",
      "sportsbook": "draftkings",
      "selection": "Los Angeles Lakers +6.5",
      "odds": -105,
      "decimalOdds": 1.952,
      "sharpOdds": -110,
      "sharpDecimalOdds": 1.909,
      "sharpBook": "pinnacle",
      "fairProbability": 52.4,
      "evPercent": 4.8,
      "kellyPercent": 2.5,
      "edgePercent": 2.2,
      "combinedScore": 3.9,
      "confidence": "high",
      "marketLiquidity": "high",
      "timeUntilStart": 28800,
      "detectedAt": "2024-01-15T10:30:00.000Z"
    }
  ]
}

Confidence Calculation:
- HIGH: EV >= 5% + Kelly >= 2% + 4+ books offering market
- MEDIUM: EV >= 3% + Kelly >= 1% + 2+ books
- LOW: Below medium thresholds

--------------------------------------------------------------------------------
GET /middles
--------------------------------------------------------------------------------
Detects middle opportunities in spread/total markets.

Authentication: Required (Sharp tier only)
Rate Limit: Standard

What is a Middle?
When different sportsbooks offer spread/total lines that create a gap where
both bets could win. Example: Book A has Lakers -3.5, Book B has Celtics +5.5.
If Lakers win by 4 or 5, both bets win.

Query Parameters:
| Parameter   | Type   | Required | Default | Description                  |
|-------------|--------|----------|---------|------------------------------|
| sports      | string | No       | all     | Comma-separated sports       |
| min_gap     | number | No       | 1       | Minimum gap size             |
| market_type | string | No       | both    | "spread", "total", or "both" |
| limit       | integer| No       | 50      | Max results (max 200)        |

Example Request:
  curl -H "X-API-Key: sk_test_sharp" \
    "https://sharpapi.io/api/v1/middles?sports=nba&min_gap=2"

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "summary": {
    "total": 5,
    "avgMiddleSize": 2.3,
    "avgBestCase": 85.0,
    "byMarketType": { "spread": 3, "total": 2 }
  },
  "count": 5,
  "middles": [
    {
      "eventId": "evt_nba_lal_bos_20240115",
      "eventName": "Los Angeles Lakers @ Boston Celtics",
      "sport": "basketball",
      "league": "NBA",
      "marketType": "spread",
      "side1": {
        "book": "draftkings",
        "selection": "Boston Celtics",
        "line": -4.5,
        "odds": { "american": -110, "decimal": 1.909, "probability": 0.524 },
        "stakePercent": 52.4
      },
      "side2": {
        "book": "fanduel",
        "selection": "Los Angeles Lakers",
        "line": +7.5,
        "odds": { "american": -110, "decimal": 1.909, "probability": 0.524 },
        "stakePercent": 47.6
      },
      "middleSize": 3.0,
      "middleNumbers": [5, 6, 7],
      "worstCaseLoss": 4.8,
      "bestCaseProfit": 90.9,
      "breakEvenPercent": 5.0,
      "detectedAt": "2024-01-15T10:30:00.000Z"
    }
  ]
}

Middle Outcome Scenarios:
- Celtics win by 8+: Side1 wins, Side2 loses → Small loss
- Celtics win by 5-7: BOTH win → Big profit
- Lakers win or Celtics win by 1-4: Side1 loses, Side2 wins → Small loss

================================================================================
STREAMING ENDPOINTS (SSE)
================================================================================

Server-Sent Events (SSE) provide real-time updates without polling.

Connection Example (JavaScript):
```javascript
const eventSource = new EventSource(
  'https://sharpapi.io/api/v1/stream/odds?sports=nba',
  { headers: { 'X-API-Key': 'sk_your_key' } }
);

eventSource.onmessage = (event) => {
  const data = JSON.parse(event.data);
  console.log('Update:', data.type, data.data);
};

eventSource.onerror = (error) => {
  console.error('Stream error:', error);
  eventSource.close();
};
```

Connection Example (curl):
```bash
curl -N -H "X-API-Key: sk_test_pro" \
  "https://sharpapi.io/api/v1/stream/odds?sports=nba"
```

Message Format:
```
data: {"type":"odds_update","timestamp":"2024-01-15T10:30:00.000Z","data":{...}}

data: {"type":"heartbeat","timestamp":"2024-01-15T10:30:30.000Z"}
```

--------------------------------------------------------------------------------
GET /stream/odds
--------------------------------------------------------------------------------
Real-time odds updates via Server-Sent Events.

Authentication: Required (any tier)
Stream Limit: Per tier (Free: 1, Pro: 3, Sharp: 10)

Query Parameters:
| Parameter | Type   | Required | Default | Description                   |
|-----------|--------|----------|---------|-------------------------------|
| sports    | string | No       | all     | Comma-separated sports        |
| books     | string | No       | all     | Comma-separated sportsbooks   |

Event Types:
- connected: Initial connection acknowledgment
- initial: Full snapshot of current odds
- odds_update: Incremental odds changes
- heartbeat: Keep-alive (every 30 seconds)
- error: Error notification

Example:
```bash
curl -N -H "X-API-Key: sk_test_free" \
  "https://sharpapi.io/api/v1/stream/odds?sports=nba,nfl"
```

--------------------------------------------------------------------------------
GET /stream/ev
--------------------------------------------------------------------------------
Real-time +EV opportunity alerts.

Authentication: Required (Pro+ tier)
Stream Limit: Per tier

Query Parameters:
| Parameter | Type   | Required | Default | Description                   |
|-----------|--------|----------|---------|-------------------------------|
| sports    | string | No       | all     | Comma-separated sports        |
| min_ev    | number | No       | 2.0     | Minimum EV threshold          |

Event Types:
- connected: Connection with config confirmation
- initial: Current EV opportunities snapshot
- ev_update: New or updated EV opportunity
- ev_expired: EV opportunity no longer valid
- heartbeat: Keep-alive

Example:
```bash
curl -N -H "X-API-Key: sk_test_pro" \
  "https://sharpapi.io/api/v1/stream/ev?sports=nba&min_ev=3.0"
```

--------------------------------------------------------------------------------
GET /stream/arbitrage
--------------------------------------------------------------------------------
Real-time arbitrage opportunity alerts.

Authentication: Required (Pro+ tier)
Stream Limit: Per tier

Query Parameters:
| Parameter  | Type   | Required | Default | Description                   |
|------------|--------|----------|---------|-------------------------------|
| sports     | string | No       | all     | Comma-separated sports        |
| min_profit | number | No       | 0.5     | Minimum profit percentage     |

Event Types:
- connected: Connection acknowledgment
- initial: Current arbitrage opportunities
- arb_update: New or updated arbitrage
- arb_expired: Arbitrage no longer valid
- heartbeat: Keep-alive

Example:
```bash
curl -N -H "X-API-Key: sk_test_pro" \
  "https://sharpapi.io/api/v1/stream/arbitrage?min_profit=1.0"
```

--------------------------------------------------------------------------------
GET /stream/combined
--------------------------------------------------------------------------------
Unified stream with all opportunity types.

Authentication: Required (Sharp tier only)
Stream Limit: 10 concurrent

Query Parameters:
| Parameter | Type   | Required | Default | Description                   |
|-----------|--------|----------|---------|-------------------------------|
| sports    | string | No       | all     | Comma-separated sports        |
| min_ev    | number | No       | 2.0     | Minimum EV percentage         |
| min_arb   | number | No       | 0.5     | Minimum arbitrage profit      |

Event Types:
- connected: Connection with configuration
- initial: Snapshot of all opportunities
- ev_update: EV opportunity update
- arbitrage_update: Arbitrage update
- heartbeat: Keep-alive

Example:
```bash
curl -N -H "X-API-Key: sk_test_sharp" \
  "https://sharpapi.io/api/v1/stream/combined?sports=nba&min_ev=3.0"
```

================================================================================
USER ENDPOINTS
================================================================================

GET /user/stats
--------------------------------------------------------------------------------
Returns API usage statistics for the authenticated user.

Authentication: Required (any tier)
Rate Limit: Standard

Example Request:
  curl -H "X-API-Key: sk_test_pro" https://sharpapi.io/api/v1/user/stats

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "stats": {
    "keyId": "key_abc123",
    "tier": "pro",
    "usage": {
      "requestsToday": 1250,
      "requestsThisMonth": 28500,
      "streamsActive": 2,
      "streamsAllowed": 3
    },
    "limits": {
      "requestsPerMinute": 1000,
      "dataDelay": 0
    }
  },
  "rateLimit": {
    "limit": 1000,
    "remaining": 875,
    "reset": "2024-01-15T10:31:00.000Z"
  },
  "features": [
    "odds",
    "ev",
    "arbitrage",
    "streaming",
    "player_props"
  ],
  "upgrade": {
    "url": "https://sharpapi.io/pricing",
    "nextTier": "sharp"
  }
}

================================================================================
REFERENCE ENDPOINTS
================================================================================

GET /books
--------------------------------------------------------------------------------
Returns list of available sportsbooks.

Authentication: Required (any tier)
Rate Limit: Standard

Example Request:
  curl -H "X-API-Key: sk_test_free" https://sharpapi.io/api/v1/books

Example Response:
{
  "success": true,
  "timestamp": "2024-01-15T10:30:00.000Z",
  "books": [
    {
      "id": "draftkings",
      "name": "DraftKings",
      "isSharp": false,
      "regions": ["US"],
      "features": ["live_betting", "player_props", "sgp"],
      "oddsCount": 2500,
      "lastUpdate": "2024-01-15T10:30:00.000Z"
    },
    {
      "id": "pinnacle",
      "name": "Pinnacle",
      "isSharp": true,
      "regions": ["EU", "LATAM", "APAC"],
      "features": ["sharp_odds", "high_limits"],
      "oddsCount": 1800,
      "lastUpdate": "2024-01-15T10:30:00.000Z"
    }
  ]
}

Sportsbook Reference (15+ books):
| ID          | Name           | Sharp | Region    | Notes              |
|-------------|----------------|-------|-----------|--------------------|
| draftkings  | DraftKings     | No    | US        | Most markets       |
| fanduel     | FanDuel        | No    | US        | Good promos        |
| betmgm      | BetMGM         | No    | US        | -                  |
| caesars     | Caesars        | No    | US        | -                  |
| espnbet     | ESPN Bet       | No    | US        | Formerly Barstool  |
| fanatics    | Fanatics       | No    | US        | New entrant        |
| betrivers   | BetRivers      | No    | US        | -                  |
| pointsbet   | PointsBet      | No    | US        | -                  |
| pinnacle    | Pinnacle       | YES   | Global    | Sharp reference    |
| bet365      | Bet365         | No    | UK/EU/AU  | International      |
| unibet      | Unibet         | No    | EU/US     | -                  |
| hardrock    | Hard Rock Bet  | No    | US        | Regional           |
| superbook   | SuperBook      | No    | US        | -                  |
| wynnbet     | WynnBET        | No    | US        | -                  |
| betfred     | Betfred        | No    | UK/US     | -                  |

================================================================================
REFERENCE DATA
================================================================================

SPORTS
--------------------------------------------------------------------------------
| ID          | Name       | Leagues                           |
|-------------|------------|-----------------------------------|
| basketball  | Basketball | NBA, NCAAB, WNBA, EuroLeague     |
| football    | Football   | NFL, NCAAF, CFL, XFL             |
| hockey      | Hockey     | NHL, AHL, KHL                     |
| baseball    | Baseball   | MLB, NPB, KBO                     |
| soccer      | Soccer     | EPL, LaLiga, Serie A, Bundesliga  |
| tennis      | Tennis     | ATP, WTA, Grand Slams            |
| mma         | MMA        | UFC, Bellator, ONE, PFL          |
| golf        | Golf       | PGA, LIV, DP World               |

MARKET TYPES
--------------------------------------------------------------------------------
| ID               | Name              | Has Line | Description              |
|------------------|-------------------|----------|--------------------------|
| moneyline        | Moneyline         | No       | Pick the winner          |
| spread           | Point Spread      | Yes      | Margin of victory        |
| total            | Total O/U         | Yes      | Combined score           |
| team_total       | Team Total        | Yes      | Single team score        |
| player_prop      | Player Props      | Yes      | Player statistics        |
| alternate_spread | Alt Spread        | Yes      | Non-standard spread      |
| alternate_total  | Alt Total         | Yes      | Non-standard total       |
| futures          | Futures           | No       | Championship, MVP, etc.  |

SELECTION TYPES
--------------------------------------------------------------------------------
| Type          | Description                                    |
|---------------|------------------------------------------------|
| home          | Home team                                      |
| away          | Away team                                      |
| draw          | Tie/Draw (soccer)                              |
| over          | Total over line                                |
| under         | Total under line                               |
| player        | Player prop selection                          |
| other         | Other selection type                           |

EVENT STATUS
--------------------------------------------------------------------------------
| Status       | Description                                    |
|--------------|------------------------------------------------|
| scheduled    | Not yet started                                |
| in_progress  | Currently live                                 |
| suspended    | Temporarily paused                             |
| completed    | Game finished                                  |
| cancelled    | Game cancelled                                 |
| postponed    | Game postponed                                 |

================================================================================
ODDS CONVERSION REFERENCE
================================================================================

American to Decimal:
- Positive (+150): decimal = (american / 100) + 1 = 2.50
- Negative (-150): decimal = (100 / |american|) + 1 = 1.667

Decimal to Probability:
- probability = 1 / decimal
- Example: 2.50 decimal = 40% probability

American to Probability:
- Positive (+150): prob = 100 / (american + 100) = 40%
- Negative (-150): prob = |american| / (|american| + 100) = 60%

Common Odds Reference:
| American | Decimal | Probability |
|----------|---------|-------------|
| -500     | 1.20    | 83.3%       |
| -300     | 1.33    | 75.0%       |
| -200     | 1.50    | 66.7%       |
| -150     | 1.67    | 60.0%       |
| -110     | 1.91    | 52.4%       |
| +100     | 2.00    | 50.0%       |
| +110     | 2.10    | 47.6%       |
| +150     | 2.50    | 40.0%       |
| +200     | 3.00    | 33.3%       |
| +300     | 4.00    | 25.0%       |
| +500     | 6.00    | 16.7%       |

================================================================================
BEST PRACTICES
================================================================================

1. AUTHENTICATION
   - Use header authentication (X-API-Key) for security
   - Never expose API keys in client-side code
   - Use environment variables for key storage

2. RATE LIMITING
   - Monitor X-RateLimit-Remaining headers
   - Implement exponential backoff on 429 responses
   - Use batch endpoints to reduce request count
   - Cache responses when appropriate

3. STREAMING
   - Implement reconnection logic with exponential backoff
   - Handle heartbeat timeouts (reconnect if no message for 45s)
   - Close connections properly when done
   - Don't open multiple streams for same data

4. ERROR HANDLING
   - Always check for error responses
   - Use the 'code' field for programmatic handling
   - Log full error responses for debugging
   - Implement graceful degradation

5. DATA FRESHNESS
   - Odds can change rapidly (seconds)
   - Always check timestamps before placing bets
   - Use streaming for time-sensitive applications
   - Implement staleness detection (>30s = stale)

6. CACHING
   - Cache static data (sports, books, market types)
   - Don't cache live odds > 5 seconds
   - Use ETags for conditional requests
   - Cache EV/arbitrage for 10-30 seconds

================================================================================
CODE EXAMPLES
================================================================================

JAVASCRIPT/TYPESCRIPT
--------------------------------------------------------------------------------

```javascript
// REST API Client
const SHARP_API_BASE = 'https://sharpapi.io/api/v1';
const API_KEY = process.env.SHARP_API_KEY;

async function getOdds(sports = []) {
  const params = new URLSearchParams();
  if (sports.length) params.set('sports', sports.join(','));

  const response = await fetch(
    `${SHARP_API_BASE}/odds?${params}`,
    { headers: { 'X-API-Key': API_KEY } }
  );

  if (!response.ok) {
    const error = await response.json();
    throw new Error(`API Error: ${error.code}`);
  }

  return response.json();
}

// SSE Streaming with Reconnection
function createOddsStream(sports, callbacks) {
  let retries = 0;
  const maxRetries = 5;
  const baseDelay = 1000;

  function connect() {
    const url = new URL(`${SHARP_API_BASE}/stream/odds`);
    if (sports.length) url.searchParams.set('sports', sports.join(','));

    const eventSource = new EventSource(url, {
      headers: { 'X-API-Key': API_KEY }
    });

    eventSource.onmessage = (event) => {
      retries = 0; // Reset on successful message
      const data = JSON.parse(event.data);

      switch (data.type) {
        case 'odds_update':
          callbacks.onUpdate?.(data.data);
          break;
        case 'heartbeat':
          callbacks.onHeartbeat?.(data);
          break;
      }
    };

    eventSource.onerror = () => {
      eventSource.close();

      if (retries < maxRetries) {
        const delay = baseDelay * Math.pow(2, retries);
        retries++;
        setTimeout(connect, delay);
      } else {
        callbacks.onMaxRetries?.();
      }
    };

    return eventSource;
  }

  return connect();
}

// Usage
const stream = createOddsStream(['nba', 'nfl'], {
  onUpdate: (odds) => console.log('New odds:', odds),
  onHeartbeat: () => console.log('Connection alive'),
  onMaxRetries: () => console.error('Stream disconnected')
});
```

PYTHON
--------------------------------------------------------------------------------

```python
import requests
from sseclient import SSEClient
import json
import os

SHARP_API_BASE = 'https://sharpapi.io/api/v1'
API_KEY = os.environ['SHARP_API_KEY']

def get_ev_opportunities(sports=None, min_ev=2.0):
    """Fetch +EV betting opportunities"""
    params = {'min_ev': min_ev}
    if sports:
        params['sports'] = ','.join(sports)

    response = requests.get(
        f'{SHARP_API_BASE}/ev',
        headers={'X-API-Key': API_KEY},
        params=params
    )
    response.raise_for_status()
    return response.json()

def stream_arbitrage(sports=None, min_profit=0.5, callback=None):
    """Stream arbitrage opportunities"""
    params = {'min_profit': min_profit}
    if sports:
        params['sports'] = ','.join(sports)

    url = f'{SHARP_API_BASE}/stream/arbitrage'
    response = requests.get(
        url,
        headers={'X-API-Key': API_KEY},
        params=params,
        stream=True
    )

    client = SSEClient(response)
    for event in client.events():
        data = json.loads(event.data)
        if callback:
            callback(data)
        else:
            print(f"[{data['type']}]", data.get('data', data))

# Usage
opportunities = get_ev_opportunities(['nba'], min_ev=3.0)
for opp in opportunities['opportunities']:
    print(f"{opp['selection']}: {opp['evPercent']}% EV at {opp['sportsbook']}")

# Streaming (blocking)
stream_arbitrage(['nba', 'nfl'], callback=lambda d: print(d))
```

CURL EXAMPLES
--------------------------------------------------------------------------------

```bash
# Get NBA moneyline odds
curl -H "X-API-Key: $SHARP_API_KEY" \
  "https://sharpapi.io/api/v1/odds?sports=nba&market_type=moneyline"

# Find +EV opportunities > 3%
curl -H "X-API-Key: $SHARP_API_KEY" \
  "https://sharpapi.io/api/v1/ev?min_ev=3.0"

# Search for Lakers games
curl -H "X-API-Key: $SHARP_API_KEY" \
  "https://sharpapi.io/api/v1/events/search?q=lakers"

# Stream odds updates (use -N for no-buffer)
curl -N -H "X-API-Key: $SHARP_API_KEY" \
  "https://sharpapi.io/api/v1/stream/odds?sports=nba"

# Get usage statistics
curl -H "X-API-Key: $SHARP_API_KEY" \
  "https://sharpapi.io/api/v1/user/stats"
```

================================================================================
COMING SOON
================================================================================

The following features are in development:

ODDS MOVEMENTS (/odds/movements)
- Historical line changes over time
- Opening vs current line comparison
- Movement velocity and direction

ODDS HISTORY (/odds/history)
- Point-in-time odds snapshots
- Historical data for backtesting
- Closing line archive

RESULTS & GRADING (/results/*)
- Final scores and outcomes
- Automatic bet settlement
- Performance tracking

SAME-GAME PARLAYS (/markets/sgp)
- SGP odds from DraftKings/FanDuel
- Correlation analysis
- True odds calculation

WEBHOOKS (/webhooks)
- Push notifications for opportunities
- Custom filters and thresholds
- Retry logic and delivery tracking

USER PREFERENCES (/user/preferences)
- Saved filters and settings
- Favorite teams and sports
- Notification preferences

================================================================================
SUPPORT
================================================================================

Documentation: https://docs.sharpapi.io
Pricing: https://sharpapi.io/pricing
API Status: https://status.sharpapi.io
Support Email: support@sharpapi.io

================================================================================
END OF DOCUMENTATION
================================================================================
